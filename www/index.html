
<!-- This is the project specific website template -->
<!-- It can be changed as liked or replaced by other content -->

<!DOCTYPE html
	PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
	"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en   ">

  <head>
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
	<title>inlinedocs</title>
	<link href="estilo1.css" rel="stylesheet" type="text/css" />
  </head>

<body>


<h1>Simple and sustainable R packaging using inlinedocs</h1>

<p> You wrote a bunch of R code, now you want to share it with
everyone, so you are making a package. Most likely you have a bunch of
functions in a file, and now you have to write all the documentation
for them. Now how to go about doing that?
  </p>

<ul>

<li><b>Option 1: do it yourself.</b> Fire up package.skeleton() and
then edit the Rd files by hand, following the directions in <a
href="http://cran.r-project.org/doc/manuals/R-exts.html">Writing R
Extensions (over 150 pages in PDF form)</a> --- good luck. It takes a
long time to edit all these files by hand, and if you change your code
you will end up with docs which do not agree. Unless you constantly
update all those Rd files. (will you really?)</li>

<li><b>Option 2: <a href="http://roxygen.org/">Roxygen</a>.</b> You
like the idea of combining source code with documentation, because
then you can do "literate programming" and moreover, it is practically
easier to keep them in sync with each other. But ROxygen has a number
of drawbacks, especially for documenting function arguments. The huge
headers are usually far away from the actual code being documented,
and you have to repeat yourself when you name the function arguments
in the comment and the definition. (but to its credit, the call graphs
that Roxygen makes are pretty cool).</li>

<li><b>Option 3: inlinedocs.</b> You will never have to repeat
yourself, just comment your code in natural places, and you get Rd
files that pass R CMD check so you can publish that package and move
on with your life. And when you make changes to that function, the
docs are right next to the code so odds are you will update the docs
if they need to be.</li>

</ul>

<img src="inlinedocs-demo.png" alt="simple example of inlinedocs usage" />

<p>Then put your code in pkgdir/R/code.file.R, write a
pkgdir/DESCRIPTION, start R, and do:</p>

<pre>
install.packages("inlinedocs",repos="http://r-forge.r-project.org")
library(inlinedocs)
package.skeleton.dx("/path/to/your/pkgdir")
</pre>

<p>Then you are done! You will get Rd files in pkgdir/man that are
guaranteed to pass R CMD check! Some notes/tips:</p>

<ul>

<li>Use an editor where you can comment-fill easily, like <a
href="http://www.gnu.org/software/emacs">Emacs</a> with <a
href="http://ess.r-project.org">ESS</a>. Then you just type "###" and
go on as long as you want with your comment. When you're done and you
have a really long comment, do a M-q to automatically break lines and
add ### prefixes.</li>

<li>Some more examples:<ul>

<li>inlinedocs:
<a href="http://r-forge.r-project.org/plugins/scmsvn/viewcvs.php/pkg/inlinedocs/R/package.skeleton.dx.R?root=inlinedocs&amp;view=markup">package.skeleton.dx.R</a>
<a href="http://r-forge.r-project.org/plugins/scmsvn/viewcvs.php/pkg/inlinedocs/DESCRIPTION?root=inlinedocs&amp;view=markup">DESCRIPTION</a>
<a href="http://r-forge.r-project.org/plugins/scmsvn/viewcvs.php/pkg/inlinedocs/man?root=inlinedocs">generated Rd files</a>
</li>

<li>sublogo:
<a href="http://r-forge.r-project.org/plugins/scmsvn/viewcvs.php/pkg/R/sublogo.dendrogram.R?root=sublogo&amp;view=markup">sublogo.dendrogram.R</a>
<a href="http://r-forge.r-project.org/plugins/scmsvn/viewcvs.php/pkg/DESCRIPTION?root=sublogo&amp;view=markup">DESCRIPTION</a>
<a href="http://r-forge.r-project.org/plugins/scmsvn/viewcvs.php/pkg/man?root=sublogo">generated Rd files</a>
</li>

<li>latticedl:
<a href="http://r-forge.r-project.org/plugins/scmsvn/viewcvs.php/pkg/latticedirectlabels/R/direct.labels.R?root=directlabels&amp;view=markup">direct.labels.R</a>
<a href="http://r-forge.r-project.org/plugins/scmsvn/viewcvs.php/pkg/latticedirectlabels/R/positioning.functions.R?root=directlabels&amp;view=markup">positioning.functions.R</a>
<a href="http://r-forge.r-project.org/plugins/scmsvn/viewcvs.php/pkg/latticedirectlabels/DESCRIPTION?root=directlabels&amp;view=markup">DESCRIPTION</a>
<a href="http://r-forge.r-project.org/plugins/scmsvn/viewcvs.php/pkg/latticedirectlabels/man?root=directlabels">generated Rd files</a>
</li>

<li>nicholsonppp:
<a href="http://r-forge.r-project.org/plugins/scmsvn/viewcvs.php/pkg/R/sim.R?root=nicholsonppp&amp;view=markup">sim.R</a>
<a href="http://r-forge.r-project.org/plugins/scmsvn/viewcvs.php/pkg/R/plot.R?root=nicholsonppp&amp;view=markup">plot.R</a>
<a href="http://r-forge.r-project.org/plugins/scmsvn/viewcvs.php/pkg/DESCRIPTION?root=nicholsonppp&amp;view=markup">DESCRIPTION</a>
<a href="http://r-forge.r-project.org/plugins/scmsvn/viewcvs.php/pkg/man?root=nicholsonppp">generated Rd files</a>
</li>

</ul></li>

<li>You can add a description of a data item declared in your code by
adding a ### comment on the line before the variable is first
declared.</li>

<li>The DESCRIPTION file is used by inlinedocs for the Maintainer
(this becomes the author section of the Rd files) and Package (this is
used as the name argument to package.skeleton). DESCRIPTION is also
used for constructing the pkgname-package Rd file, so you have to
include these fields: Version License Description Title Author. If
you're really lazy (like me), and you haven't written one yet,
inlinedocs will create an empty DESCRIPTION file for you.
</li>

<li>You still have to manually document your datasets (the files in
pkgdir/data), but these don't change often, so that's no problem
to do by hand. To get started just use the prompt() function.</li>

<li>To add examples for FUN, add a file FUN.R to your pkgdir/tests
directory. This is more sustainable than putting test code in R
comments, since debugging/changing commented code is a pain. You can
also add inline examples by putting code at the end of FUN (see
example below).</li>

<li>For additional flexibility, inlinedocs now allows documentation of
S4 class definitions (i.e. those which use
<tt>setClass</tt>) and includes additional triggers based on the
string "##&lt;&lt;". This means that most of the standard documentation
sections can be filled in from wherever is relevant in the source
code, as follows:

<br />

<a href="http://r-forge.r-project.org/plugins/scmsvn/viewcvs.php/pkg/inlinedocs/tests/fermat/?root=inlinedocs">

  <img src="fermat.png" alt="how to use inlinedocs to implement the
fermat example from roxygen" /></a>

</li>

<li> ##&lt;&lt; at the end of a line can be used to add function
argument descriptions on the same line as an argument name - any
immediately following ## comment lines will also be included.  </li>

<li> ##xxx&lt;&lt; as the first non-white space element on a line introduces
a section of consecutive ## comment lines which will be placed in the
"xxx" section of the documentation, where xxx is one of: alias,
details, keyword, references, author, note, seealso, value, title or
description. Multiple such chunks are concatenated appropriately - you
can think of this as something like the C++ "put" operator putting
chunks into that section.  For further details and examples of these
look for &lt;&lt; in the source file <a
href="http://r-forge.r-project.org/plugins/scmsvn/viewcvs.php/pkg/inlinedocs/R/package.skeleton.dx.R?root=inlinedocs&amp;view=markup">package.skeleton.dx.R</a>
</li>

<li> ##describe&lt;&lt; within such a documentation chunk allows a
"describe" block within that chunk to be constructed using same-line
##&lt;&lt; comments (as for the function arguments). All the following
source lines until another ##xxx&lt;&lt; line will be scanned for such
same-line comments. (##end&lt;&lt; may be used to end such a block and
return to the same documentation chunk.) This allows named lists to be
documented using the names actually in the code so that it is less
easy to forget to document when you add an element.</li>

<li>The package includes a <a
href="http://r-forge.r-project.org/plugins/scmsvn/viewcvs.php/pkg/inlinedocs/tests/silly/R/silly.example.R?root=inlinedocs&amp;view=markup">silly example</a>, which (as the file name suggests) is a very silly function indeed but exercises most of these facilities.</li>

</ul>

<h1>NEW in version 1.2! Extending inlinedocs!</h1>

<p>inlinedocs operates using a modular system of source code parsers,
so it is very simple to extend. To do this, you need to write a custom
parser function that takes takes your source as input and returns a
list of documentation objects. For example, by default inlinedocs
copies the Maintainer line of the DESCRIPTION file to the author
section of the Rd file. To use the Author line from DESCRIPTION
instead, do this:</p>

<pre>
### This function will be applied to every object in your package.
author.from.author &lt;- function(desc,...){
  list(author=desc[,"Author"])
### Returns a list with named values that will be used to add
### documentation to Rd files.
}

## author.from.description is the name of the default parser for the
## author section. We copy all the other parsers functions in the
## list, then add our custom author parser to the end of the list.
my.parsers &lt;-
  c(default.parsers["author.from.description"!=names(default.parsers)],
    forall(author.from.author))
## forall(FUN) returns a function that will apply FUN to all
## documentation objects in your package. Likewise, forfun(FUN) will
## apply FUN to all functions in your package.

package.skeleton.dx("/path/to/my/pkgdir",my.parsers)
</pre>

<p>This is just a simple example, but you can write a parser function
that does anything you like! Here is the list of arguments each parser
function receives, when it is used in conjunction with
forall/forfun:</p>

<table>
  <tr>
    <td>o</td>
    <td>The R object.</td>
  </tr>
  <tr>
    <td>name</td>
    <td>The name of the object.</td>
  </tr>
  <tr>
    <td>src</td>
    <td>For a function, the source lines of the function as a
    character vector.</td>
  </tr>
  <tr>
    <td>doc</td>
    <td>The list of documentation strings already constructed for this
    object.</td>
  </tr>
  <tr>
    <td>objs</td>
    <td>The named list of all objects in the package.</td>
  </tr>
  <tr>
    <td>docs</td>
    <td>The named list of all documentation lists already
    constructed.</td>
  </tr>
  <tr>
    <td>code</td>
    <td>All of the source code in the package's *.R files.</td>
  </tr>
  <tr>
    <td>desc</td>
    <td>The DESCRIPTION as read by read.dcf.</td>
  </tr>
</table>

<p>If you don't specify a parser list for package.skeleton.dx, then it
will first check for the variable "parsers" in pkgdir/R/.inlinedocs.R,
then options("inlinedocs.parsers") (which you could define in your
~/.Rprofile). If neither of these is found, it will use
inlinedocs::default.parsers. So you can use this feature to have
project- and user-specific inlinedocs parsers!</p>

<p> Return to
the <a href="http://r-forge.r-project.org/projects/inlinedocs/">project
summary page</a>. </p>

<center>
<table>
<tr>

<td>Please send email
to <a href="mailto:inlinedocs-support@lists.r-forge.r-project.org">the
support list</a>
(or <a href="https://lists.r-forge.r-project.org/cgi-bin/mailman/listinfo/inlinedocs-support">subscribe</a>)
if you are using inlinedocs or have ideas to contribute, thanks!</td>

</tr>
<tr>
<td align="center">
    <a href="http://validator.w3.org/check?uri=referer">validate</a>
</td>
</tr>
</table>

</center>


</body>
</html>
